"use strict";(self.webpackChunkk_8_s_god=self.webpackChunkk_8_s_god||[]).push([[190],{28453:(e,r,n)=>{n.d(r,{R:()=>d,x:()=>l});var s=n(96540);const c={},i=s.createContext(c);function d(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),s.createElement(i.Provider,{value:r},e.children)}},52046:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"docker/docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93","title":"docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93","description":"\u5b89\u88c5registry","source":"@site/docs/docker/docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93.md","sourceDirName":"docker","slug":"/docker/docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93","permalink":"/blog/docs/docker/docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/docker/docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"docker\u642d\u5efaC\u8bed\u8a00\u5f00\u53d1\u73af\u5883","permalink":"/blog/docs/docker/docker\u642d\u5efaC\u8bed\u8a00\u5f00\u53d1\u73af\u5883"},"next":{"title":"docker\u8bbe\u7f6e\u5bb9\u5668\u72ec\u7acbip\uff08linux\u4e0b\u865a\u62df\u673a\u8bbe\u7f6e\u72ec\u7acbip\uff09","permalink":"/blog/docs/docker/docker\u8bbe\u7f6e\u5bb9\u5668\u72ec\u7acbip"}}');var c=n(74848),i=n(28453);const d={},l="docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93",o={},t=[{value:"\u5b89\u88c5registry",id:"\u5b89\u88c5registry",level:2},{value:"\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93\u5230registry",id:"\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93\u5230registry",level:2},{value:"\u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93ui",id:"\u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93ui",level:2}];function a(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.header,{children:(0,c.jsx)(r.h1,{id:"docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93",children:"docker\u642d\u5efa\u4e2a\u4eba\u955c\u50cf\u4ed3\u5e93"})}),"\n",(0,c.jsx)(r.h2,{id:"\u5b89\u88c5registry",children:"\u5b89\u88c5registry"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"mkdir docker-registry\ncd docker-registry\nmkdir registry\nmkdr auth\nvim docker-compose.yml\n"})}),"\n",(0,c.jsx)(r.p,{children:"docker-compose.yml\u7684\u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"version: '3'\nservices:\n  registry:\n    image: registry\n    container_name: registry\n    volumes:\n      - ./registry:/var/lib/registry\n      - ./auth:/auth\n    environment:\n      - REGISTRY_AUTH=htpasswd\n      - REGISTRY_AUTH_HTPASSWD_REALM=Registry_Realm\n      - REGISTRY_AUTH_HTPASSWD_PATH=/auth/passwd\n    restart: always\n    ports:\n      - \"5000:5000\"\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u7528htpasswd\u5148\u751f\u6210\u4e00\u4e2a\u5bc6\u7801\uff0c\u7136\u540e\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230auth\u4e0b\u9762\uff0c\u7528\u8fd9\u4e2a\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u3002"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"htpasswd -Bbc htpasswd.user admin 123456\nmv htpasswd.user auth/passwd\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u7136\u540e\u518d\u542f\u52a8\u955c\u50cf\uff1a"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"docker-compose up -d\n"})}),"\n",(0,c.jsx)(r.h2,{id:"\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93\u5230registry",children:"\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93\u5230registry"}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u7f16\u8f91docker\u914d\u7f6e\u6587\u4ef6"}),"\n"]}),"\n",(0,c.jsx)(r.p,{children:"\u5728 /etc/docker/daemon.json \u6587\u4ef6\u4e2d\u5199\u5165\u5982\u4e0b\u5185\u5bb9\uff1a"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-json",children:'    {\n        "registry-mirror": [\n          "https://registry.docker-cn.com"\n        ],\n        "insecure-registries": [\n          "ip:port"\n        ]\n    }\n'})}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u4fee\u6539\u5b8c\u6210\u540e\u91cd\u542fdocker\u670d\u52a1"}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"systemctl restart docker\n"})}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u767b\u5f55\u5230docker registry"}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"(base) \u279c  docker_registry git:(main) \u2717 sudo docker login http://192.168.80.20:5000\nUsername: admin\nPassword: \nWARNING! Your password will be stored unencrypted in /root/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\n\nLogin Succeeded\n"})}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u52a0\u4e0a\u4e2a\u4eba\u4ed3\u5e93\u6807\u7b7e\u7136\u540epush"}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"docker tag registry 192.168.80.20:5000/registry\ndocker push 192.168.80.20:5000/registry\n"})}),"\n",(0,c.jsx)(r.h2,{id:"\u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93ui",children:"\u8bbe\u7f6e\u955c\u50cf\u4ed3\u5e93ui"}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6"}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"vim registry_ui.yml\n"})}),"\n",(0,c.jsx)(r.p,{children:"\u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-yaml",children:"version: '3'\nservices:\n  registry-ui:\n    image: konradkleine/docker-registry-frontend:v2\n    container_name: registry_ui\n    restart: always\n    privileged: true\n    environment:\n      - ENV_DOCKER_REGISTRY_HOST=192.168.80.20\n      - ENV_DOCKER_REGISTRY_PORT=5000\n    ports:\n      - \"5001:80\"\n"})}),"\n",(0,c.jsxs)(r.ul,{children:["\n",(0,c.jsx)(r.li,{children:"\u542f\u52a8registry-ui"}),"\n"]}),"\n",(0,c.jsx)(r.pre,{children:(0,c.jsx)(r.code,{className:"language-shell",children:"docker-compose -f registry_ui.yml up -d\n"})})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,c.jsx)(r,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}}}]);