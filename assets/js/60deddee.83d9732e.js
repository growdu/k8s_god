"use strict";(self.webpackChunkk_8_s_god=self.webpackChunkk_8_s_god||[]).push([[1706],{12799:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>p,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"vpp/vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863","title":"vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863","description":"\u5148\u5c06vpp_arm64.tar.gz\u590d\u5236\u5230\u76ee\u6807\u673a\u5668\u4e0a\u8fdb\u884c\u89e3\u538b\uff0c\u89e3\u538b\u540e\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a","source":"@site/docs/vpp/vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863.md","sourceDirName":"vpp","slug":"/vpp/vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863","permalink":"/blog/docs/vpp/vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/vpp/vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"vpp\u4ee3\u7801\u6d41\u7a0b\u5206\u6790","permalink":"/blog/docs/vpp/vpp\u4ee3\u7801\u6d41\u7a0b\u56fe"},"next":{"title":"vpp\u591a\u7f51\u53e3\u8f6c\u53d1","permalink":"/blog/docs/vpp/vpp\u591a\u7f51\u53e3\u8f6c\u53d1"}}');var l=s(74848),i=s(28453);const p={},d="vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863",c={},a=[{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:2},{value:"\u7ed1\u5b9adpdk\u7f51\u53e3",id:"\u7ed1\u5b9adpdk\u7f51\u53e3",level:3},{value:"\u9a71\u52a8\u6a21\u5757\u52a0\u8f7d",id:"\u9a71\u52a8\u6a21\u5757\u52a0\u8f7d",level:2},{value:"vpp\u914d\u7f6e\u6587\u4ef6",id:"vpp\u914d\u7f6e\u6587\u4ef6",level:2},{value:"kni\u914d\u7f6e\u548c\u4f7f\u7528",id:"kni\u914d\u7f6e\u548c\u4f7f\u7528",level:2}];function t(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863",children:"vpp\u4f7f\u7528\u8bf4\u660e\u6587\u6863"})}),"\n",(0,l.jsx)(e.p,{children:"\u5148\u5c06vpp_arm64.tar.gz\u590d\u5236\u5230\u76ee\u6807\u673a\u5668\u4e0a\u8fdb\u884c\u89e3\u538b\uff0c\u89e3\u538b\u540e\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"root@localhost-Technical-B:~/vpp/vpp# ls\nbin  dpaa2  vpp_readme  include  install.sh  kmod  lib  share  startup.conf  usertools  vpp_papi-1.6.2-py2.7.egg\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u9996\u5148\u9605\u8bfbvpp_readme\uff0c\u53ef\u6839\u636e\u8be5\u6587\u6863\u8fdb\u884c\u5b89\u88c5\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u5b89\u88c5\u65f6\u9700\u8981\u8fd0\u884cinstall.sh\u811a\u672c\uff0c\u8be5\u811a\u672c\u4e3b\u8981\u628a\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u62f7\u8d1d\u5230\u76ee\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u5e76\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"chmod +x install.sh\n./install.sh /mnt/\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u73af\u5883\u51c6\u5907",children:"\u73af\u5883\u51c6\u5907"}),"\n",(0,l.jsx)(e.h3,{id:"\u7ed1\u5b9adpdk\u7f51\u53e3",children:"\u7ed1\u5b9adpdk\u7f51\u53e3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"dynamic_dpl.sh dpmac.4\nexport DPRC=dprc.2\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u9a71\u52a8\u6a21\u5757\u52a0\u8f7d",children:"\u9a71\u52a8\u6a21\u5757\u52a0\u8f7d"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u82e5\u9700\u8981\u5f00\u542fkni\u529f\u80fd\uff0c\u5219\u9700\u8981\u52a0\u8f7drte_kni.ko\u6a21\u5757\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u52a0\u8f7d\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"insmod rte_kni.ko carrier=on\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662fcarrier=on\u5728dpdk18.05\u7248\u672c\u540e\u4e0d\u80fd\u7701\u7565\uff0c\u56e0\u4e3adpdk18.05\u7248\u672c\u540ecarrier\u9ed8\u8ba4\u4e3aoff\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u82e5\u4e0d\u9700\u8981\u5f00\u542fkni\u529f\u80fd\uff0c\u5219\u9700\u8981\u786e\u4fddrte_kni.ko\u6a21\u5757\u5df2\u7ecf\u88ab\u5378\u8f7d"}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u67e5\u770brte_kni.ko\u662f\u5426\u5b58\u5728"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"lsmod | grep rte_kni\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u82e5\u5b58\u5728\u5219\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u5378\u8f7d\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"rmmod rte_kni\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"vpp\u914d\u7f6e\u6587\u4ef6",children:"vpp\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,l.jsx)(e.p,{children:"vpp\u914d\u7f6e\u6587\u4ef6\u4e0evpp\u914d\u7f6e\u4e00\u81f4\uff0c\u53ef\u76f4\u63a5\u53c2\u8003vpp startup.conf\u76f8\u5173\u914d\u7f6e\uff08\u5305\u62eckni\uff09\u3002"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u7ebf\u7a0b\u53c2\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"cpu {\n        main-core 4\n        corelist-workers 5\n}\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u4e00\u822c\u4f7f\u7528\u4e00\u4e2amain\u7ebf\u7a0b\u548c\u4e00\u4e2aworker\u7ebf\u7a0b\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"dpdk\u53c2\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"dpdk {\n        ## Change default settings for all intefaces\n        huge-dir /mnt/hugepages\n        no-pci\n        num-mem-channels 1\n        # kni count\n        #kni 1\n         dev default {\n                ## Number of receive queues, enables RSS\n                ## Default is 1\n                num-rx-queues 1\n                num-rx-desc 40960\n                #num-rx-desc 65536\n                rss { ipv4 }\n\n                ## Number of transmit queues, Default is equal\n                ## to number of worker threads or 1 if no workers treads\n                num-tx-queues 1\n        }\n        proc-type primary\n        log-level 7\n}\n\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5176\u4e2d\u9700\u8981\u7279\u522b\u7559\u610f\u7684\u662fnum-rx-desc\uff0c\u8be5\u503c\u662fdpdk\u7684\u73af\u5f62\u6536\u5305\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u82e5\u8bbe\u7f6e\u8fc7\u5c0f\u4f1a\u5bfc\u81f4dpdk\u4e22\u5305\u3002\u6309\u5f53\u524d\u6d4b\u8bd5\u7ed3\u679c\u6765\u770b40960\u4e3a\u6700\u4f18\u503c\uff0c\u82e5\u5927\u6d41\u91cf\u65f6\u51fa\u73b0\u5927\u91cfrx-errors\u53ef\u9002\u5f53\u589e\u5927\u8be5\u503c\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u53e6\u5916\u82e5\u9700\u8981\u542f\u7528kni\u529f\u80fd\uff0c\u76f4\u63a5\u5728dpdk\u914d\u7f6e\u4e2d\u6dfb\u52a0"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"kni count\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u5373\u53ef\uff0c\u5176\u4e2dcount\u662f\u8981\u652f\u6301kni\u7684\u7f51\u53e3\u4e2a\u6570\u3002kni\u7f51\u53e3\u4e2a\u6570\u4f9d\u8d56\u4e8e\u5b9e\u9645\u7684\u7269\u7406\u7f51\u53e3\u4e2a\u6570\uff0ckni\u4e2a\u6570\u65e0\u6cd5\u8d85\u8fc7\u5b9e\u9645\u7269\u7406\u7f51\u53e3\u4e2a\u6570\u3002\u5373kni\u662f\u4e0e\u7269\u7406\u7f51\u53e3\u4e00\u4e00\u5bf9\u5e94\u7684\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u63d2\u4ef6\u53c2\u6570"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"plugins {\n        ## Adjusting the plugin path depending on where the VPP plugins are\n        path /path/lib/vpp_plugins\n        vat-path /path/lib/vpp_api_test_plugins\n\n        plugin default { enable }\n        plugin gtpu_plugin.so { disable }\n}\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u63d2\u4ef6\u914d\u7f6e\u4e2d\u9700\u6307\u660evpp_plugins\u7684\u8def\u5f84\uff0c\u53e6\u5916\u9700\u5c06\u539f\u751f\u7684gtpu\u63d2\u4ef6\u7981\u7528\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"kni\u914d\u7f6e\u548c\u4f7f\u7528",children:"kni\u914d\u7f6e\u548c\u4f7f\u7528"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u914d\u7f6e"}),"\n",(0,l.jsx)(e.p,{children:"\u5f53\u542f\u7528kni\u529f\u80fd\u65f6\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7269\u7406\u7f51\u53e3\u6765\u8bf4\uff0c\u9664vpp\u672c\u8eab\u8fdb\u884c\u6570\u636e\u5305\u5904\u7406\u5916\uff0c\u8fd8\u4f1a\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u865a\u62df\u51fa\u4e00\u4e2a\u7f51\u53e3\uff0c\u4e00\u822c\u547d\u540d\u4e3avEth0\uff0c\u5176\u4e2d0\u8ddf\u968fkni\u4e2a\u6570\u589e\u52a0\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u5bf9\u4e8e\u865a\u62df\u51fa\u6765\u7684\u7f51\u53e3\u53ef\u4f7f\u7528linux\u4e0b\u7684ifconfig\u3001ethtool\u5de5\u5177\u5bf9\u5176\u8fdb\u884c\u914d\u7f6e\u3002\u53ef\u4ee5\u5c06\u5176\u5f53\u4f5c\u6b63\u5e38\u7684\u7269\u7406\u7f51\u53e3\u6765\u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u67e5\u770b"}),"\n",(0,l.jsx)(e.p,{children:"\u67e5\u770bkni\u7edf\u8ba1\u4fe1\u606f\uff0c\u53ef\u76f4\u63a5\u4f7f\u7528vppctl\u5de5\u5177\u3002"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"vpp# show int\n              Name               Idx    State  MTU (L3/IP4/IP6/MPLS)     Counter          Count\nTenGigabitEthernet0               1      up          1500/0/0/0\nlocal0                            0     down          0/0/0/0\n----------------------------------------------------------------------------------------------------\nvEth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9216\n        inet 121.168.1.12  netmask 255.255.255.0  broadcast 121.168.1.255\n        inet6 fe80::b0c4:a3ff:feba:2ddf  prefixlen 64  scopeid 0x20<link>\n        ether b2:c4:a3:ba:2d:df  txqueuelen 1000  (Ethernet)\n        RX packets 8  bytes 708 (708.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 16  bytes 1364 (1.3 KB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-shell",children:"vpp# show int addr\nTenGigabitEthernet0 (up):\n  L3 192.168.8.25/16\nlocal0 (dn):\n----------------------------------------------------------------------------------------------------\nvEth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9216\n        inet 121.168.1.12  netmask 255.255.255.0  broadcast 121.168.1.255\n        inet6 fe80::b0c4:a3ff:feba:2ddf  prefixlen 64  scopeid 0x20<link>\n        ether b2:c4:a3:ba:2d:df  txqueuelen 1000  (Ethernet)\n        RX packets 0  bytes 0 (0.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 10  bytes 796 (796.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n"})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5206\u6d41"}),"\n",(0,l.jsx)(e.p,{children:"\u5206\u6d41\u662f\u6307\u9700\u8981\u51b3\u5b9a\u4e00\u4e2a\u62a5\u6587\u662f\u8be5\u9001\u5f80kni\u7ecf\u5185\u6838\u534f\u8bae\u6808\u5904\u7406\uff0c\u8fd8\u662f\u8be5\u9001\u5f80vpp\u7531\u7528\u6237\u6001\u534f\u8bae\u6808\u5904\u7406\u3002\u5f53\u524d\u9ed8\u8ba4\u5206\u6d41\u539f\u5219\u4e3aGTPU\u62a5\u6587\u9001\u5f80\u7528\u6237\u6001\u534f\u8bae\u6808\uff0c\u975eGTPU\u62a5\u6587\u9001\u5f80\u5185\u6838\u534f\u8bae\u6808\u3002\u56e0\u5f53\u524d\u65e0\u5176\u4ed6\u5206\u6d41\u7b56\u7565\uff0c\u6682\u65f6\u4e0d\u652f\u6301\u5206\u6d41\u7b56\u7565\u914d\u7f6e\uff0c\u5747\u91c7\u7528\u9ed8\u8ba4\u5206\u6d41\u7b56\u7565\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)("font",{color:"red",children:"\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u524dkni\u548cvpp\u53ef\u4ee5\u914d\u7f6e\u76f8\u540c\u7684ip\uff0c\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e0d\u540c\u7684ip\u3002\u4f46kni\u548cvpp\u7684\u7f51\u53e3\u7269\u7406\u5730\u5740\u5fc5\u987b\u76f8\u540c\u3002"})]})}function o(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(t,{...n})}):t(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>p,x:()=>d});var r=s(96540);const l={},i=r.createContext(l);function p(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:p(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);