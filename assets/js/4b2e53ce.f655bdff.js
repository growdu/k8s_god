"use strict";(self.webpackChunkk_8_s_god=self.webpackChunkk_8_s_god||[]).push([[902],{28453:(e,_,c)=>{c.d(_,{R:()=>t,x:()=>l});var n=c(96540);const r={},s=n.createContext(r);function t(e){const _=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(_):{..._,...e}}),[_,e])}function l(e){let _;return _=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),n.createElement(s.Provider,{value:_},e.children)}},49855:(e,_,c)=>{c.r(_),c.d(_,{assets:()=>d,contentTitle:()=>l,default:()=>a,frontMatter:()=>t,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"cluster/DCF/dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3","title":"dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3","description":"\u8282\u70b9\u7c7b\u578b","source":"@site/docs/cluster/DCF/dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3.md","sourceDirName":"cluster/DCF","slug":"/cluster/DCF/dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3","permalink":"/blog/docs/cluster/DCF/dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cluster/DCF/dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"dcf\u5199\u5165\u673a\u5236","permalink":"/blog/docs/cluster/DCF/dcf\u5199\u5165\u673a\u5236"},"next":{"title":"dcf\u8fd0\u884c\u673a\u5236","permalink":"/blog/docs/cluster/DCF/dcf\u8fd0\u884c\u673a\u5236"}}');var r=c(74848),s=c(28453);const t={},l="dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3",d={},o=[{value:"\u8282\u70b9\u7c7b\u578b",id:"\u8282\u70b9\u7c7b\u578b",level:2},{value:"\u6295\u7968\u6a21\u5f0f",id:"\u6295\u7968\u6a21\u5f0f",level:2},{value:"\u6295\u7968\u521d\u59cb\u5316",id:"\u6295\u7968\u521d\u59cb\u5316",level:2},{value:"\u6d88\u606f\u5904\u7406\u51fd\u6570",id:"\u6d88\u606f\u5904\u7406\u51fd\u6570",level:2},{value:"\u6d88\u606f\u6d41\u7a0b",id:"\u6d88\u606f\u6d41\u7a0b",level:2}];function i(e){const _={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.header,{children:(0,r.jsx)(_.h1,{id:"dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3",children:"dcf\u6295\u7968\u7cfb\u7edf\u8be6\u89e3"})}),"\n",(0,r.jsx)(_.h2,{id:"\u8282\u70b9\u7c7b\u578b",children:"\u8282\u70b9\u7c7b\u578b"}),"\n",(0,r.jsx)(_.pre,{children:(0,r.jsx)(_.code,{className:"language-c",children:"typedef enum en_dcf_role {\n    DCF_ROLE_UNKNOWN = 0,\n    DCF_ROLE_LEADER, \n    DCF_ROLE_FOLLOWER,\n    DCF_ROLE_LOGGER,\n    DCF_ROLE_PASSIVE,\n    DCF_ROLE_PRE_CANDIDATE,\n    DCF_ROLE_CANDIDATE,\n    DCF_ROLE_CEIL,\n} dcf_role_t;\n"})}),"\n",(0,r.jsx)(_.h2,{id:"\u6295\u7968\u6a21\u5f0f",children:"\u6295\u7968\u6a21\u5f0f"}),"\n",(0,r.jsx)(_.pre,{children:(0,r.jsx)(_.code,{className:"language-c",children:"typedef enum en_param_run_mode {\n    ELECTION_AUTO,\n    ELECTION_MANUAL,\n    ELECTION_DISABLE,\n    ELECTION_CEIL,\n} param_run_mode_t;\n"})}),"\n",(0,r.jsx)(_.h2,{id:"\u6295\u7968\u521d\u59cb\u5316",children:"\u6295\u7968\u521d\u59cb\u5316"}),"\n",(0,r.jsx)(_.mermaid,{value:"graph TB\nelc_init--\x3eelc_stream_init--\x3eregister_msg_process--\x3ecm_create_thread\ncm_create_thread--\x3e|\u5fc3\u8df3\u7ebf\u7a0b,\u5b9a\u65f6\u53d1\u9001\u5fc3\u8df3\u62a5\u6587|elc_status_check_entry--\x3eelc_stream_is_exists--\x3emd_get_stream_nodes_count--\x3eelc_send_status_info\ncm_create_thread--\x3e|\u9009\u4e3b\u7ebf\u7a0b,\u5b9a\u65f6\u76d1\u63a7leader\u53d8\u5316|elc_status_notify_entry--\x3eelc_stream_notify_proc--\x3eget_notify_item--\x3erep_try_promote_prio_leader--\x3erep_role_notify"}),"\n",(0,r.jsx)(_.h2,{id:"\u6d88\u606f\u5904\u7406\u51fd\u6570",children:"\u6d88\u606f\u5904\u7406\u51fd\u6570"}),"\n",(0,r.jsx)(_.pre,{children:(0,r.jsx)(_.code,{className:"language-c",children:"    register_msg_process(MEC_CMD_VOTE_REQUEST_RPC_REQ, elc_vote_proc, PRIV_HIGH);\n    register_msg_process(MEC_CMD_VOTE_REQUEST_RPC_ACK, elc_vote_ack_proc, PRIV_HIGH);\n    register_msg_process(MEC_CMD_PROMOTE_LEADER_RPC_REQ, elc_promote_proc, PRIV_HIGH);\n    register_msg_process(MEC_CMD_STATUS_CHECK_RPC_REQ, elc_status_check_req_proc, PRIV_HIGH);\n    register_msg_process(MEC_CMD_STATUS_CHECK_RPC_ACK, elc_status_check_ack_proc, PRIV_HIGH);\n"})}),"\n",(0,r.jsxs)(_.ul,{children:["\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_VOTE_REQUEST_RPC_REQ"})}),"\n"]}),"\n",(0,r.jsx)(_.mermaid,{value:"graph TB\nelc_vote_proc--\x3e|\u83b7\u53d6\u5f53\u524d\u8282\u70b9|elc_stream_get_current_node--\x3e|\u89e3\u7801vote\u8bf7\u6c42|elc_decode_vote_req--\x3e|\u5224\u65ad\u6295\u7968|elc_judge_vote--\x3e|\u5206\u914d\u4e00\u4e2a\u5305\u8fdb\u884c\u76f8\u5e94|mec_alloc_pack--\x3e|\u7ec4\u88c5vote ack|elc_encode_vote_ack--\x3e|\u53d1\u9001\u7ed9\u5bf9\u7aef|mec_send_data--\x3e|\u91ca\u653e\u7533\u8bf7\u7684\u5305|mec_release_pack"}),"\n",(0,r.jsxs)(_.ul,{children:["\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_VOTE_REQUEST_RPC_ACK"})}),"\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_PROMOTE_LEADER_RPC_REQ"})}),"\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_STATUS_CHECK_RPC_REQ"})}),"\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_STATUS_CHECK_RPC_REQ"})}),"\n",(0,r.jsx)(_.li,{children:(0,r.jsx)(_.code,{children:"MEC_CMD_STATUS_CHECK_RPC_ACK"})}),"\n"]}),"\n",(0,r.jsx)(_.h2,{id:"\u6d88\u606f\u6d41\u7a0b",children:"\u6d88\u606f\u6d41\u7a0b"}),"\n",(0,r.jsx)(_.mermaid,{value:"sequenceDiagram\n\u8282\u70b91->>\u8282\u70b92: \u53d1\u9001MEC_CMD_STATUS_CHECK_RPC_REQ\n\u8282\u70b92->>\u8282\u70b91: MEC_CMD_VOTE_REQUEST_RPC_ACK"})]})}function a(e={}){const{wrapper:_}={...(0,s.R)(),...e.components};return _?(0,r.jsx)(_,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}}}]);