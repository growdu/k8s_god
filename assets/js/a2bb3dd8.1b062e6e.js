"use strict";(self.webpackChunkk_8_s_god=self.webpackChunkk_8_s_god||[]).push([[2759],{28453:(e,n,l)=>{l.d(n,{R:()=>i,x:()=>r});var a=l(96540);const t={},s=a.createContext(t);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(s.Provider,{value:n},e.children)}},35126:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"linux/vlan\u4f7f\u7528\u6307\u5317","title":"vlan\u4f7f\u7528\u6307\u5317","description":"vlan\u8be6\u7ec6\u5185\u5bb9\u8bf7\u53c2\u8003\u535a\u5ba2\u3002","source":"@site/docs/linux/vlan\u4f7f\u7528\u6307\u5317.md","sourceDirName":"linux","slug":"/linux/vlan\u4f7f\u7528\u6307\u5317","permalink":"/blog/docs/linux/vlan\u4f7f\u7528\u6307\u5317","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/linux/vlan\u4f7f\u7528\u6307\u5317.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"uboot\u6307\u5317","permalink":"/blog/docs/linux/uboot\u6307\u5317"},"next":{"title":"\u4e0d\u5f97\u4e0d\u77e5\u9053\u7684linux\u5e93\u7684\u88c5\u8f7d\u3001\u94fe\u63a5","permalink":"/blog/docs/linux/\u4e0d\u5f97\u4e0d\u77e5\u9053\u7684linux\u5e93\u7684\u88c5\u8f7d\u3001\u94fe\u63a5"}}');var t=l(74848),s=l(28453);const i={},r="vlan\u4f7f\u7528\u6307\u5317",o={},c=[{value:"vlan\u7684\u4f5c\u7528",id:"vlan\u7684\u4f5c\u7528",level:2},{value:"\u4f7f\u7528vlan",id:"\u4f7f\u7528vlan",level:3},{value:"\u52a0\u8f7d8021q\u6a21\u5757",id:"\u52a0\u8f7d8021q\u6a21\u5757",level:3},{value:"\u5b89\u88c5vconfig",id:"\u5b89\u88c5vconfig",level:3},{value:"\u914d\u7f6evlan",id:"\u914d\u7f6evlan",level:3},{value:"\u8bbe\u7f6evlan\u4f18\u5148\u7ea7",id:"\u8bbe\u7f6evlan\u4f18\u5148\u7ea7",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"vlan\u4f7f\u7528\u6307\u5317",children:"vlan\u4f7f\u7528\u6307\u5317"})}),"\n",(0,t.jsxs)(n.p,{children:["vlan\u8be6\u7ec6\u5185\u5bb9\u8bf7\u53c2\u8003",(0,t.jsx)(n.a,{href:"https://blog.csdn.net/qq_38265137/article/details/80390759",children:"\u535a\u5ba2"}),"\u3002"]}),"\n",(0,t.jsx)(n.p,{children:'VLAN\uff08Virtual Local Area Network\uff09\u7684\u4e2d\u6587\u540d\u4e3a"\u865a\u62df\u5c40\u57df\u7f51"\u3002'}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"LAN\u53ef\u4ee5\u662f\u7531\u5c11\u6570\u51e0\u53f0\u5bb6\u7528\u8ba1\u7b97\u673a\u6784\u6210\u7684\u7f51\u7edc\uff0c\u4e5f\u53ef\u4ee5\u662f\u6570\u4ee5\u767e\u8ba1\u7684\u8ba1\u7b97\u673a\u6784\u6210\u7684\u4f01\u4e1a\u7f51\u7edc\u3002VLAN\u6240\u6307\u7684LAN\u7279\u6307\u4f7f\u7528\u8def\u7531\u5668\u5206\u5272\u7684\u7f51\u7edc\u2014\u2014\u4e5f\u5c31\u662f\u5e7f\u64ad\u57df\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7b80\u5355\u6765\u8bf4\uff0c\u540c\u4e00\u4e2aVLAN\u4e2d\u7684\u7528\u6237\u95f4\u901a\u4fe1\u5c31\u548c\u5728\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u4e00\u6837\uff0c\u540c\u4e00\u4e2aVLAN\u4e2d\u7684\u5e7f\u64ad\u53ea\u6709VLAN\u4e2d\u7684  \u6210\u5458\u624d\u80fd\u542c\u5230\uff0c\u800c\u4e0d\u4f1a\u4f20\u8f93\u5230\u5176\u4ed6\u7684VLAN\u4e2d\u53bb\uff0c\u4ece\u800c\u63a7\u5236\u4e0d\u5fc5\u8981\u7684\u5e7f\u64ad\u98ce\u66b4\u7684\u4ea7\u751f\u3002\u540c\u65f6\uff0c  \u82e5\u6ca1\u6709\u8def\u7531\uff0c\u4e0d\u540cVLAN\u4e4b\u95f4\u4e0d\u80fd\u76f8\u4e92\u901a\u4fe1\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u4e0d\u540c\u5de5\u4f5c\u7ec4\u4e4b\u95f4\u7684\u4fe1\u606f\u5b89\u5168\u6027\u3002\u7f51\u7edc  \u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6eVLAN\u4e4b\u95f4\u7684\u8def\u7531\u6765\u5168\u9762\u7ba1\u7406\u7f51\u7edc\u5185\u90e8\u4e0d\u540c\u5de5\u4f5c\u7ec4\u4e4b\u95f4\u7684\u4fe1\u606f\u4e92\u8bbf\u3002"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"VLAN\u901a\u8fc7\u9650\u5236\u5e7f\u64ad\u5e27\u8f6c\u53d1\u7684\u8303\u56f4\u5206\u5272\u4e86\u5e7f\u64ad\u57df\u3002"}),"\n",(0,t.jsx)(n.li,{children:"VLAN\u751f\u6210\u7684\u903b\u8f91\u4e0a\u7684\u4ea4\u6362\u673a\u662f\u4e92\u4e0d\u76f8\u901a\u7684\u3002\u56e0\u6b64\uff0c\u5728\u4ea4\u6362\u673a\u4e0a\u8bbe\u7f6eVLAN\u540e\uff0c\u5982\u679c\u672a\u505a\u5176\u4ed6\u5904\u7406\uff0cVLAN\u95f4\u662f\u65e0\u6cd5\u901a\u4fe1\u7684\u3002"}),"\n",(0,t.jsxs)(n.li,{children:["VLAN\u95f4\u7684\u901a\u4fe1\u4e5f\u9700\u8981\u8def\u7531\u5668\u63d0\u4f9b\u4e2d\u7ee7\u670d\u52a1\uff0c\u8fd9\u88ab\u79f0\u4f5c\u201cVLAN\u95f4\u8def\u7531\u201d\u3002\u8f6c\u81ea",(0,t.jsx)(n.a,{href:"http://www.qianjia.com/html/2019-03/19_329607.html",children:"\u535a\u5ba2"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"vlan\u7684\u4f5c\u7528",children:"vlan\u7684\u4f5c\u7528"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u9650\u5236\u5e7f\u64ad\u57df\uff1a\u5e7f\u64ad\u57df\u88ab\u9650\u5236\u5728\u4e00\u4e2aVLAN\u5185\uff0c\u8282\u7701\u4e86\u5e26\u5bbd\uff0c\u63d0\u9ad8\u4e86\u7f51\u7edc\u5904\u7406\u80fd\u529b\u3002"}),"\n",(0,t.jsx)(n.li,{children:"\u589e\u5f3a\u5c40\u57df\u7f51\u7684\u5b89\u5168\u6027\uff1a\u4e0d\u540cVLAN\u5185\u7684\u62a5\u6587\u5728\u4f20\u8f93\u65f6\u662f\u76f8\u4e92\u9694\u79bb\u7684\uff0c\u5373\u4e00\u4e2aVLAN\u5185\u7684\u7528\u6237\u4e0d\u80fd\u548c\u5176\u5b83VLAN\u5185\u7684\u7528\u6237\u76f4\u63a5\u901a\u4fe1\u3002"}),"\n",(0,t.jsx)(n.li,{children:"\u63d0\u9ad8\u4e86\u7f51\u7edc\u7684\u5065\u58ee\u6027\uff1a\u6545\u969c\u88ab\u9650\u5236\u5728\u4e00\u4e2aVLAN\u5185\uff0c\u672cVLAN\u5185\u7684\u6545\u969c\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6VLAN\u7684\u6b63\u5e38\u5de5\u4f5c\u3002"}),"\n",(0,t.jsxs)(n.li,{children:["\u7075\u6d3b\u6784\u5efa\u865a\u62df\u5de5\u4f5c\u7ec4\uff1a\u7528VLAN\u53ef\u4ee5\u5212\u5206\u4e0d\u540c\u7684\u7528\u6237\u5230\u4e0d\u540c\u7684\u5de5\u4f5c\u7ec4\uff0c\u540c\u4e00\u5de5\u4f5c\u7ec4\u7684\u7528\u6237\u4e5f\u4e0d\u5fc5\u5c40\u9650\u4e8e\u67d0\u4e00\u56fa\u5b9a\u7684\u7269\u7406\u8303\u56f4\uff0c\u7f51\u7edc\u6784\u5efa\u548c\u7ef4\u62a4\u66f4\u65b9\u4fbf\u7075\u6d3b\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3aCSDN\u535a\u4e3b\u300c\u66f9\u4e16\u5b8f\u7684\u535a\u5ba2\u300d\u7684\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faaCC 4.0 BY-SA\u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u53ca\u672c\u58f0\u660e\u3002\n\u539f\u6587\u94fe\u63a5\uff1a",(0,t.jsx)(n.a,{href:"https://blog.csdn.net/qq_38265137/article/details/80390759",children:"https://blog.csdn.net/qq_38265137/article/details/80390759"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"\u4f7f\u7528vlan",children:"\u4f7f\u7528vlan"}),"\n",(0,t.jsx)(n.h3,{id:"\u52a0\u8f7d8021q\u6a21\u5757",children:"\u52a0\u8f7d8021q\u6a21\u5757"}),"\n",(0,t.jsx)(n.p,{children:"vlan\u534f\u8bae\u5373IEE8021Q\uff0c\u5728linux\u5185\u6838\u4e2d\u82e5\u60f3\u4f7f\u7528vlan\u534f\u8bae\uff0c\u9700\u5148\u52a0\u8f7d8021q\u6a21\u5757\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"lsmod | grep 8021q\n# \u82e5\u6ca1\u6709\u9700\u5148\u52a0\u8f7d\nmodprobe 8021q\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u5b89\u88c5vconfig",children:"\u5b89\u88c5vconfig"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"wget https://download-ib01.fedoraproject.org/pub/epel/7/x86_64/Packages/v/vconfig-1.9-16.el7.x86_64.rpm\nrpm -Uvh vconfig-1.9-16.el7.x86_64.rpm\n"})}),"\n",(0,t.jsx)(n.p,{children:"vconfig\u53c2\u6570\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Expecting argc to be 3-5, inclusive.  Was: 2\n\nUsage: add             [interface-name] [vlan_id]\n       rem             [vlan-name]\n       set_flag        [interface-name] [flag-num]       [0 | 1]\n       set_egress_map  [vlan-name]      [skb_priority]   [vlan_qos]\n       set_ingress_map [vlan-name]      [skb_priority]   [vlan_qos]\n       set_name_type   [name-type]\n\n* The [interface-name] is the name of the ethernet card that hosts\n  the VLAN you are talking about.\n* The vlan_id is the identifier (0-4095) of the VLAN you are operating on.\n* skb_priority is the priority in the socket buffer (sk_buff).\n* vlan_qos is the 3 bit priority in the VLAN header\n* name-type:  VLAN_PLUS_VID (vlan0005), VLAN_PLUS_VID_NO_PAD (vlan5),\n              DEV_PLUS_VID (eth0.0005), DEV_PLUS_VID_NO_PAD (eth0.5)\n* bind-type:  PER_DEVICE  # Allows vlan 5 on eth0 and eth1 to be unique.\n              PER_KERNEL  # Forces vlan 5 to be unique across all devices.\n* FLAGS:  1 REORDER_HDR  When this is set, the VLAN device will move the\n            ethernet header around to make it look exactly like a real\n            ethernet device.  This may help programs such as DHCPd which\n            read the raw ethernet packet and make assumptions about the\n            location of bytes.  If you don't need it, don't turn it on, because\n            there will be at least a small performance degradation.  Default\n            is OFF.\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6evlan",children:"\u914d\u7f6evlan"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# \u5728\u7269\u7406\u7f51\u53e3ens33\u4e0a\u914d\u7f6evlan id\u4e3a100\u7684vlan\u7f51\u53e3\nvconfig add ens33 100\nvconfig add ens33 200\n#\u8bbe\u7f6eVLAN\u7684REORDER_HDR\u53c2\u6570\nvconfig set_flag ens33.100 1 1\nvconfig set_flag ens33.200 1 1\n#\u914d\u7f6eip\nifconfig ens33.100 172.168.1.100/24 up\nifconfig ens33.200 172.168.1.200/24 up\n#\u67e5\u770b\u914d\u7f6e\u4fe1\u606f\ncat /proc/net/vlan/ens33.100\ncat /proc/net/vlan/ens33.200\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u8bbe\u7f6evlan\u4f18\u5148\u7ea7",children:"\u8bbe\u7f6evlan\u4f18\u5148\u7ea7"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# \u5c06vlan\u51fa\u53e3\u5305\u7684\u4f18\u5148\u7ea7\u6539\u4e3a2\n[root@localhost ~]# vconfig set_egress_map ens33.100 vlan_qos 2\nSet egress mapping on device -:ens33.100:- Should be visible in /proc/net/vlan/ens33.100\n[root@localhost ~]# cat /proc/net/vlan/ens33.100\nens33.100  VID: 100      REORDER_HDR: 1  dev->priv_flags: 1\n         total frames received            0\n          total bytes received            0\n      Broadcast/Multicast Rcvd            0\n\n      total frames transmitted          145\n       total bytes transmitted        11140\nDevice: ens33\nINGRESS priority mappings: 0:0  1:0  2:0  3:0  4:0  5:0  6:0 7:0\n EGRESS priority mappings: 0:2\n[root@localhost ~]#\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);